"0",""
"0","saltify <- "
"0","  function(initial_volume, desired_percentage, starting_percentage, temperature) {"
"0","    library(tidyverse)"
"0","    # Density and molarity of ammonium sulfate solutions"
"0","    AS <- tibble(temperature = c(0, 10, 20, 25), "
"0","                 specVol = c(0.5281, 0.5357, 0.5414, 0.5435), "
"0","                 sat = c(515.35, 524.60, 536.49, 541.80), "
"0","                 Msat = c(3.90, 3.97, 4.06, 4.10)"
"0","    )"
"0","    # Use a linear model to obtain temperature values ranging from 0 to 25 "
"0","    m1 <- lm(specVol~temperature, data = AS)"
"0","    m2 <- lm(sat~temperature, data = AS)"
"0","    m3 <- lm(Msat~temperature, data = AS)"
"0","    ASlm <- tibble(temperature = c(0:25))"
"0","    AS <- tibble(temperature = c(0:25), "
"0","                 specVol = predict(object = m1, newdata = ASlm), "
"0","                 sat = predict(object = m2, newdata = ASlm), "
"0","                 Msat = predict(object = m3, newdata = ASlm)"
"0","    )"
"0","    G <- cbind.data.frame(temperature = AS$temperature, "
"0","                          values = rep(NA, length(AS$temperature)))"
"0","    for (i in 1:length(AS$temperature)) {"
"0","      M1 <- starting_percentage/100*AS$Msat[i]"
"0","      M2 <- desired_percentage/100*AS$Msat[i]"
"0","      G$values[i] <- "
"0","        AS$sat[i]*(M2-M1)/(AS$Msat[i]-(AS$specVol[i]/1000*132.14*AS$Msat[i]*M2))"
"0","    }"
"0","    G$values <- G$values*initial_volume/1000"
"0","    return(paste(""You need to add "", "
"0","                 round(G[G$temperature == temperature, ""values""], "
"0","                       digits = 2), "
"0","                 "" g of ammonium sulfate to an initial volume of "", "
"0","                 initial_volume, "
"0","                 "" mL in order to increase the ammonium sulfate saturation from "", "
"0","                 starting_percentage, ""%"", "" to "", desired_percentage, ""% at "", "
"0","                 temperature, "" Â°C."", sep = """"))"
"0","  }"
"0",""
